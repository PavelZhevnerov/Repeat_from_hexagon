function playGame(){function e(e){gainNodes[e].gain.linearRampToValueAtTime(vol,audioCtx.currentTime+ramp),N.currPush=$("#"+e),N.currPush.addClass("light")}function t(){N.currPush&&N.currPush.removeClass("light"),gainNodes.forEach(function(e){e.gain.linearRampToValueAtTime(0,audioCtx.currentTime+ramp)}),N.currPush=void 0,N.currOsc=void 0}function n(){errNode.gain.linearRampToValueAtTime(vol,audioCtx.currentTime+ramp)}function r(){errNode.gain.linearRampToValueAtTime(0,audioCtx.currentTime+ramp)}function i(e,t){t=t||0;setTimeout(function(){y.text(e)},t)}function o(){(v=$("input[name=diff]:checked").val())||(v=15)}function a(){h(),t(),r(),x.text("--").removeClass("led-off"),c("--",1),N.init(),p(),o()}function s(e){var t=[1250,1e3,750,500];return e<4?t[0]:e<8?t[1]:e<12?t[2]:t[3]}function u(e){N.lock=!0,E.removeClass("clickable").addClass("unclickable"),n(),i("You are wrong!"),e&&e.addClass("light"),N.toHndl=setTimeout(function(){r(),e&&e.removeClass("light"),N.toHndlSt=setTimeout(function(){N.strict?a():d()},1e3)},1e3),c("!!",2)}function l(){var n=0,r=N.lastPush.attr("id");N.seqHndl=setInterval(function(){e(r),N.toHndl=setTimeout(t,80),8===++n&&clearInterval(N.seqHndl)},160),c("**",2),i("You win!!!")}function c(e,t){x.text(e);var n=function(){x.addClass("led-off"),N.toHndlFl=setTimeout(function(){x.removeClass("led-off")},250)},r=0;n(),N.flHndl=setInterval(function(){n(),++r===t&&clearInterval(N.flHndl)},500)}function f(){var e=N.count<10?"0":"";x.text(e+(N.count+""))}function d(){i("Listen to me!");var n=0;N.index=0,N.seqHndl=setInterval(function(){f(),N.lock=!0,e(N.sequence[n]),N.toHndl=setTimeout(t,N.timeStep/2-10),++n===N.sequence.length&&(clearInterval(N.seqHndl),E.removeClass("unclickable").addClass("clickable"),N.lock=!1,i("Repeat after me!",1e3),N.toHndl=setTimeout(u,5*N.timeStep))},N.timeStep)}function p(){N.timeStep=s(N.count++),N.sequence.push(Math.floor(6*Math.random())),N.toHndl=setTimeout(d,500)}function h(){clearInterval(N.seqHndl),clearInterval(N.flHndl),clearTimeout(N.toHndl),clearTimeout(N.toHndlFl),clearTimeout(N.toHndlSt)}function g(t){if(!N.lock){clearTimeout(N.toHndl);var n=t.attr("id");n==N.sequence[N.index]&&N.index<N.sequence.length?(e(n),N.lastPush=t,N.index++,N.index<N.sequence.length?N.toHndl=setTimeout(u,5*N.timeStep):N.index==v?(E.removeClass("clickable").addClass("unclickable"),N.toHndl=setTimeout(l,N.timeStep)):(E.removeClass("clickable").addClass("unclickable"),p())):(E.removeClass("clickable").addClass("unclickable"),u(t))}}function m(){T.toggleClass("led-on"),N.strict=!N.strict}var v,y=$("#info"),x=$(".count"),b=$("#start"),w=$("#mode"),T=$("#mode-led"),C=$(".sw-slot"),k=$("#pwr-sw"),E=$(".hex-btn"),S=$(".btn"),N={};N.reset=function(){this.init(),this.strict=!1},N.init=function(){this.lastPush=$("#0"),this.sequence=[],this.tStepInd=0,this.index=0,this.count=0,this.lock=!1},E.mousedown(function(){g($(this))}),$("*").mouseup(function(e){e.stopPropagation(),N.lock||t()}),C.click(function(){k.toggleClass("sw-on"),0==k.hasClass("sw-on")?(i("Click on the switch!"),N.reset(),x.text("--"),x.addClass("led-off"),T.removeClass("led-on"),E.removeClass("clickable").addClass("unclickable"),b.off("click"),w.off("click"),S.removeClass("unclickable").addClass("clickable"),h(),t(),r()):(o(),i("Let's start!"),S.removeClass("unclickable").addClass("clickable"),x.removeClass("led-off"),b.click(a),w.click(m))}),N.reset()}$(document).ready(function(){window.AudioContext||window.webkitAudioContext||!1?playGame():alert("Sorry, but the Web Audio API is not supported by your browser. Please, consider downloading the latest version of Google Chrome or Mozilla Firefox")});var ramp=.05,vol=.5,audioCtx=new AudioContext,frequencies=[329.63,261.63,220,164.81,360.24,198.57],errOsc=audioCtx.createOscillator();errOsc.type="triangle",errOsc.frequency.value=110,errOsc.start(0);var errNode=audioCtx.createGain();errOsc.connect(errNode),errNode.gain.value=0,errNode.connect(audioCtx.destination);var oscillators=frequencies.map(function(e){var t=audioCtx.createOscillator();return t.type="sine",t.frequency.value=e,t.start(0),t}),gainNodes=oscillators.map(function(e){var t=audioCtx.createGain();return e.connect(t),t.connect(audioCtx.destination),t.gain.value=0,t});